{% extends 'base.html' %}
{% load wagtailcore_tags %}

{% block content %}
<div class='container mx-auto px-4 py-8'>
    <h1 class='text-3xl font-bold mb-6'>Accessibility Audits</h1>
    
    <div class='grid grid-cols-1 md:grid-cols-3 gap-4 mb-8'>
        <div class='bg-white rounded-lg shadow p-6'>
            <div class='text-sm text-gray-500 uppercase'>Total Audits</div>
            <div class='text-3xl font-bold mt-2'>{{ total_audits }}</div>
        </div>
        <div class='bg-white rounded-lg shadow p-6'>
            <div class='text-sm text-gray-500 uppercase'>Total Issues</div>
            <div class='text-3xl font-bold mt-2 text-red-600'>{{ total_issues }}</div>
        </div>
        <div class='bg-white rounded-lg shadow p-6'>
            <div class='text-sm text-gray-500 uppercase'>Latest Audit</div>
            <div class='text-lg font-medium mt-2'>
                {% if audits %}{{ audits.0.run_at|date:'Y-m-d' }}{% else %}N/A{% endif %}
            </div>
        </div>
    </div>
    
    <div class='bg-white rounded-lg shadow p-6'>
        <h2 class='text-xl font-semibold mb-4'>Recent Audits</h2>
        <table class='w-full table-fixed'>
            <thead class='border-b'>
                <tr class='text-left text-gray-500'>
                    <th class='py-2 w-1/3'>Page</th>
                    <th class='py-2 w-1/3'>URL</th>
                    <th class='py-2 w-1/6'>Date</th>
                    <th class='py-2 w-1/6'>Issues</th>
                </tr>
            </thead>
            <tbody>
                {% for audit in audits %}
                <tr class='border-b'>
                    <td class='py-2'>{{ audit.page_name }}</td>
                    <td class='py-2 break-all'>{{ audit.page_url }}</td>
                    <td class='py-2'>{{ audit.run_at|date:'Y-m-d' }}</td>
                    <td class='py-2 text-red-600 font-medium'>{{ audit.issues_found }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan='4' class='py-4 text-center text-gray-500'>No audits yet</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
